name: Reset all JSON files 6 hours after update

on:
  push:
    paths:
      - "*.json"   # triggers when any JSON file changes
  workflow_dispatch:         # allows manual trigger too

jobs:
  wait_and_reset:
    runs-on: ubuntu-latest
    steps:
      - name: Wait 6 hours before resetting
        run: |
          echo "Waiting for 6 hours before reset..."
          sleep $((6 * 60 * 60))  # 6 hours = 21600 seconds

      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Reset all JSON files
        run: |
          for file in *.json; do
            echo "Resetting $file..."
            cat > "$file" <<'EOF'
            [
              {
                "events": [
                  {
                    "name": "Join YoSinTV Telegram Channel",
                    "link": "https://t.me/yosintvlive"
                  }
                ],
                "styles": {
                  "livee": "display: flex; justify-content: center; align-items: center; text-decoration: none; color: inherit; margin: 5px 0; padding: 10px; border: 2px solid #000; border-radius: 5px; cursor: pointer; transition: box-shadow 0.3s ease; background-color: red; color: white;",
                  "liveeHover": "box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);",
                  "liveeName": "flex: 2; text-align: center; color: white; font-weight: bold;"
                }
              }
            ]
            EOF
          done

      - name: Commit and push changes
        run: |
          git config user.name "github-actions"
          git config user.email "actions@github.com"
          git add *.json
          git commit -m "Auto reset all JSON files to base template (6 hours after update)" || echo "No changes to commit"
          git push
